# AI 教材轉換器

一個專為教育訓練人員設計的智慧教材製作工具，支援 Word/PDF 上傳、AI 智慧分析、自動排版，並可輸出專業的 PDF 和 Word 文件。

## ✨ 主要功能

- 📁 **檔案上傳**：支援 Word (.docx) 和 PDF 格式
- 🤖 **AI 智慧分析**：自動標記重點、定義術語、建議圖片位置
- 🎨 **樣式自訂**：6 種預設班級顏色 + 自訂顏色
- 📖 **即時預覽**：A4 格式即時預覽
- 📄 **PDF 輸出**：高品質 PDF 下載
- 📝 **Word 輸出**：可編輯的 Word 文件
- 💾 **專案管理**：儲存草稿、載入專案
- 🎓 **新手導覽**：首次使用引導

## 🚀 快速開始

### 1. 開啟應用程式

直接雙擊 `index.html` 檔案，使用瀏覽器開啟（建議使用 Chrome 或 Edge）。

### 2. 使用流程

```
上傳檔案 → AI 分析 → 選擇顏色 → 計算頁碼 → 下載教材
```

詳細說明請參閱 [使用說明.md](使用說明.md)

## 📋 系統需求

- **瀏覽器**：Chrome 90+、Edge 90+、Firefox 88+
- **網路連線**：AI 分析功能需要連網
- **API Key**：需要 Google Gemini API Key（已內建預設 Key）

## 🔑 API Key 設定

### 取得 API Key

1. 前往 [Google AI Studio](https://aistudio.google.com/)
2. 登入 Google 帳號
3. 點選「Get API Key」
4. 創建並複製 API Key

### 設定 API Key

- 點擊應用程式中的「更換 API Key」按鈕
- 輸入您的 API Key
- 系統會自動儲存

## 📁 專案結構

```
app/
├── index.html              # 主頁面
├── 使用說明.md             # 使用說明文件
├── css/
│   └── styles.css          # 樣式檔案
└── js/
    ├── config.js           # 配置檔案（包含 API Key）
    ├── fileHandler.js      # 檔案處理模組
    ├── aiService.js        # AI 服務模組
    ├── pdfGenerator.js     # PDF 生成器
    ├── wordGenerator.js    # Word 生成器
    ├── storage.js          # 儲存管理模組
    └── main.js             # 主程式邏輯
```

## 🎯 核心技術

- **前端框架**：原生 JavaScript (ES6+)
- **樣式**：CSS3 + 響應式設計
- **AI 引擎**：Google Gemini 2.0 Flash
- **文件處理**：
  - Mammoth.js (Word 解析)
  - PDF.js (PDF 解析)
  - docx.js (Word 生成)
- **儲存**：LocalStorage

## ⚠️ 重要提醒

### 下載 PDF 前必須執行「計算頁碼」

系統需要模擬分頁位置才能正確計算目錄頁碼。

### PDF 列印設定

請確認以下設定：
- ✅ 目的地：另存為 PDF
- ✅ 紙張：A4
- ✅ **背景圖形：務必勾選**（否則顏色和圖片會消失）

## 📝 支援的內容類型

- 章節標題（H1）
- 小節標題（H2、H3）
- 一般段落
- 重點提示（藍色框）
- 術語定義（綠色框）
- 警告事項（紅色框）
- 圖片（自動排版）
- 表格（自動格式化）

## 🔧 常見問題

### Q：為什麼圖片或顏色在 PDF 中消失了？
A：請確認列印視窗中有勾選「背景圖形」選項。

### Q：目錄頁碼不正確怎麼辦？
A：在下載前重新點擊「計算頁碼」按鈕。

### Q：資料會上傳到雲端嗎？
A：不會！所有資料都儲存在瀏覽器中（除了 AI 分析需要連網）。

更多問題請參閱 [使用說明.md](使用說明.md)

## 📦 部署方式

### 方式一：本機使用
直接雙擊 `index.html` 即可使用。

### 方式二：網頁伺服器
將整個 `app` 資料夾上傳到任何靜態網頁伺服器即可。

### 方式三：GitHub Pages
1. 將專案推送到 GitHub
2. 在 Settings → Pages 啟用 GitHub Pages
3. 選擇 `app` 資料夾作為根目錄

## 🎨 自訂設定

### 修改預設 API Key

編輯 `js/config.js` 檔案：

```javascript
const CONFIG = {
    API_KEY: '您的 API Key',
    // ...
};
```

### 修改預設顏色

編輯 `js/config.js` 檔案中的 `DEFAULT_STYLES` 設定。

## 📄 授權

本專案僅供內部使用。

## 🔄 版本資訊

**版本**：1.0.0  
**發布日期**：2025-12-05

### 功能清單

- ✅ Word/PDF 檔案上傳
- ✅ 圖片自動提取與保留
- ✅ AI 智慧分析
- ✅ 自動目錄生成
- ✅ 頁碼計算
- ✅ 班級主色調設定
- ✅ PDF 高品質輸出
- ✅ Word 可編輯輸出
- ✅ 專案儲存與載入
- ✅ 新手導覽
- ⏳ 手動分頁調整（規劃中）
- ⏳ 圖片手動編輯（規劃中）

## 📞 技術支援

如有任何問題或建議，請聯絡系統管理員。

---

**開發者**：AI Assistant  
**最後更新**：2025-12-05
