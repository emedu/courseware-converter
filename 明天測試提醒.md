# 🔔 測試提醒

## 📅 預定測試時間
**2025 年 12 月 10 日（星期二）早上**

---

## ✅ 測試前確認清單

### 1. 確認 API Key 狀態
執行以下命令來測試 API Key 是否已解除限制：

```bash
cd "d:\project\教材轉換專案"
node test_api_key.js
```

**預期結果：**
- ✅ 看到「成功！API Key 正常運作！」
- ✅ AI 回應：「2」（1+1 的答案）

如果還是看到 429 錯誤，請再等 6-12 小時。

---

### 2. 啟動測試伺服器

```bash
cd "d:\project\教材轉換專案"
node server/index.js
```

**預期輸出：**
```
🔧 Gemini 服務初始化：請求延遲=6000ms, 最大重試=5次
🚀 AI 教材轉換器伺服器已啟動
📍 本地訪問: http://localhost:3000
🌍 環境: development
🔑 API Key 狀態: ✅ 已設定
```

---

### 3. 開始功能測試

1. 打開瀏覽器訪問：**http://localhost:3000**
2. 點擊「🧪 載入測試資料」
3. 點擊「🤖 開始 AI 分析」
4. **耐心等待 30-60 秒**（這是正常的，因為有速率保護機制）

**成功標誌：**
- ✅ 不再出現紅色錯誤彈窗
- ✅ 分析完成後顯示結構化內容
- ✅ 可以設定樣式並下載 PDF/Word

---

## 📊 當前系統狀態

### API 配置
- **API Key**: `AIzaSyABwkSaUvPlRomomKNlnlxk50W5yhCb5mg`
- **申請日期**: 2024-12-08
- **狀態**: 新 Key 冷靜期（預計 12-10 解除）

### 速率限制設定（已優化）
- **請求間隔**: 6 秒（保守模式）
- **最大重試**: 5 次
- **重試延遲**: 10 秒起跳（指數退避：10s → 20s → 40s → 80s → 160s）
- **佇列機制**: ✅ 已啟用（防止並發請求）

---

## 🔧 已完成的優化

1. ✅ **Promise 佇列機制**
   - 確保請求序列執行，避免並發問題
   
2. ✅ **指數退避重試**
   - 遇到 429 錯誤自動重試，延遲時間遞增

3. ✅ **保守速率限制**
   - 每次請求間隔 6 秒，遠低於 Google 限制

---

## 🆘 如果明天還是失敗

### 方案 A：申請新 Key
訪問：https://aistudio.google.com/app/apikey
創建新的 API Key 並更新到 `.env` 檔案

### 方案 B：聯繫支援
這可能表示您的 Google 帳號有其他限制

---

## 📝 備註
- 測試時請確保沒有其他程式在使用這個 API Key
- 建議在安靜的網路環境下測試（避免 IP 共用問題）
- 記得保持伺服器運行，不要中途重啟
